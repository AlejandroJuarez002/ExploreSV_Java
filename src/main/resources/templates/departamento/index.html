<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="/layouts/_mainLayout">

<head>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        .content-wrapper, .card-custom, .table, .btn, h2 {
            font-family: 'Poppins', sans-serif;
        }
        .container-fluid.departamento-container {
            background-size: cover;
        }
        .overlay-translucido {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.75);
            z-index: 1;
        }
        .content-wrapper {
            position: relative;
            z-index: 2;
        }
        .btn-nuevo {
            background-color: #4facfe;
            color: white;
            border: 0;
            padding: 0.5rem 1rem !important;
            font-size: 0.9rem !important;
        }
        .btn-nuevo:hover {
            background-color: #329af0 !important;
            color: white !important;
        }

        /* Botones de acción con color sólido */
        .btn-detalles {
            background-color: #6c757d;
            color: white !important;
            border: none;
            border-radius: 6px;
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
            margin: 0 2px;
        }
        .btn-detalles:hover {
            background-color: #5a6268 !important;
        }

        .btn-editar {
            background-color: #17a2b8;
            color: white !important;
            border: none;
            border-radius: 6px;
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
            margin: 0 2px;
        }
        .btn-editar:hover {
            background-color: #138496 !important;
        }

        .btn-eliminar {
            background-color: #dc3545;
            color: white !important;
            border: none;
            border-radius: 6px;
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
            margin: 0 2px;
        }
        .btn-eliminar:hover {
            background-color: #c82333 !important;
        }
        .card-custom {
            background-color: #ffffff;
        }
        /* Columna de acciones más compacta */
        .acciones-col {
            width: 1%;
            white-space: nowrap;
        }
        /* Ajuste del contenedor de la tabla */
        .table-container {
            overflow-x: auto;
        }
        /* Reducir ancho del contenedor */
        .card.shadow-lg {
            max-width: 900px;
            margin: 0 auto;
        }
        /* Reducir ancho columna ID */
        .table th:nth-child(1),
        .table td:nth-child(1) {
            max-width: 8px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        /* Reducir ancho columna Nombre */
        .table th:nth-child(2),
        .table td:nth-child(2) {
            max-width: 20px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* Ajustes para responsividad */
        @media (max-width: 768px) {
            .table-container {
                width: 100%;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .table {
                min-width: 600px;
                white-space: nowrap;
            }

            /* Botones de acciones apilados verticalmente */
            .acciones-col {
                width: 120px;
                white-space: normal;
            }

            .btn-detalles,
            .btn-editar,
            .btn-eliminar {
                display: block;
                width: 100%;
                margin-bottom: 0.3rem;
                text-align: center;
            }
        }
        /* Paginación */
        .pagination .page-link {
          color: #5a6c7d;
          background-color: #fff;
          border: 1px solid #eae4dc;
          border-radius: 50% !important;
          width: 40px;
          height: 40px;
          display: flex;
          align-items: center;
          justify-content: center;
          margin: 0 4px;
          transition: all 0.3s ease;
        }
        /* Efecto hover para la paginación (páginas INACTIVAS) */
        .pagination .page-link:hover {
          background-color: #6c757d;
          color: #fff;
          border-color: #6c757d;
        }
        /* Paginación activa */
        .pagination .page-item.active .page-link {
          background-color: #2c3e50;
          color: #fff;
          border-color: #2c3e50;
        }
    </style>
</head>

<div layout:fragment="content" class="container-fluid p-5 position-relative departamento-container">
    <div class="overlay-translucido"></div>

    <div class="container position-relative content-wrapper">
        <div th:if="${msg != null}">
            <script>
                Swal.fire({
                  title: "Confirmación",
                  text: '[[${msg}]]',
                  icon: "success"
                });
            </script>
        </div>

        <div th:if="${error != null}">
            <script>
                Swal.fire({
                  title: "Error",
                  text: '[[${error}]]',
                  icon: "error"
                });
            </script>
        </div>

        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="text-primary fw-bold">Listado de Departamentos</h2>
            <a th:href="@{/departamentos/create}" class="btn btn-lg shadow-sm text-white px-4 py-2 btn-nuevo">
                ➕ Nuevo departamento
            </a>
        </div>

        <div class="card shadow-lg rounded-4 border-0">
            <div class="card-body p-4 card-custom">
                <div class="table-container">
                    <table class="table table-hover align-middle">
                        <thead class="table-light">
                        <tr>
                            <th>ID</th>
                            <th>Nombre</th>
                            <th class="acciones-col">Acciones</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="item : ${departamentos}">
                            <td th:text="${item.id}" ></td>
                            <td th:text="${item.nombre}"></td>
                            <td class="acciones-col">
                                <a th:href="@{/departamentos/details/{id} (id = ${item.id})}" class="btn btn-sm btn-detalles">
                                    Detalles
                                </a>
                                <a th:href="@{/departamentos/edit/{id} (id = ${item.id})}" class="btn btn-sm btn-editar">
                                    Editar
                                </a>
                                <a th:href="@{/departamentos/remove/{id} (id = ${item.id})}" class="btn btn-sm btn-eliminar">
                                    Eliminar
                                </a>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>

                <nav aria-label="Page navigation example" class="mt-3">
                    <ul class="pagination justify-content-center">
                        <li class="page-item" th:each="pageNumber : ${pageNumbers}">
                            <a class="page-link" th:href="@{|/departamentos?page=${pageNumber}|}" th:text="${pageNumber}"></a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>
</div>
</html>